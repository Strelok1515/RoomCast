@model RoomCast.Models.MediaFile
@{
    ViewData["Title"] = "File Details";

    var sizeInMb = Model.FileSize / (1024d * 1024d);
    var uploadedAt = Model.CreatedAt.ToLocalTime().ToString("f");

    var isImage = Model.FileType.Equals("Picture", StringComparison.OrdinalIgnoreCase)
               || Model.FileType.Equals("Image", StringComparison.OrdinalIgnoreCase);

    var isVideo = Model.FileType.Equals("Video", StringComparison.OrdinalIgnoreCase);

    var isDocument = Model.FileType.Equals("Document", StringComparison.OrdinalIgnoreCase)
                  && Model.FileFormat.Equals(".pdf", StringComparison.OrdinalIgnoreCase);

}

<style>
    .details-card {
        background: #ffffff;
        border-radius: 1.25rem;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        border: 1px solid #e2e8f0;
    }

    .details-title {
        font-size: 2rem;
        font-weight: 700;
        color: #1e293b;
    }

    .details-sub {
        font-size: .9rem;
        color: #64748b;
    }

    .details-section {
        background: #ffffff;
        border-radius: 1.25rem;
        padding: 1.5rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        border: 1px solid #e2e8f0;
    }

    .label {
        color: #1e293b;
        font-weight: 600;
        font-size: .9rem;
    }

    .value {
        color: #475569;
        margin-top: .15rem;
    }

    .viewer-frame {
        width: 100%;
        height: 560px;
        border-radius: 1rem;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    }

    .btn-primary {
        background: #4f46e5;
        color: #fff;
        border-radius: .5rem;
        padding: .6rem 1.2rem;
        font-weight: 600;
        transition: .2s;
    }

        .btn-primary:hover {
            background: #4338ca;
        }

    .btn-gray {
        background: #ffffff;
        border: 1px solid #cbd5e1;
        border-radius: .5rem;
        padding: .55rem 1.1rem;
        font-weight: 600;
        color: #1e293b;
        transition: .2s;
    }

        .btn-gray:hover {
            background: #f1f5f9;
        }

</style>

@if (TempData["Message"] != null)
{
    <div class="mb-4 rounded-xl border-l-4 border-emerald-500 bg-emerald-50 p-4 text-sm text-emerald-800 shadow-sm">
        @TempData["Message"]
    </div>
}
@if (TempData["Error"] != null)
{
    <div class="mb-4 rounded-xl border-l-4 border-red-500 bg-red-50 p-4 text-sm text-red-700 shadow-sm">
        @TempData["Error"]
    </div>
}

<div class="flex flex-col gap-10 lg:flex-row">

    <!-- LEFT: FILE METADATA -->
    <section class="flex-1 space-y-8">

        <div class="details-card">
            <h2 class="details-title">@Model.Title</h2>
            <p class="details-sub">Uploaded @uploadedAt</p>
        </div>

        <div class="details-section grid grid-cols-1 sm:grid-cols-2 gap-6 text-sm">
            <div>
                <div class="label">Original File</div>
                <div class="value">@Model.OriginalFileName</div>
            </div>

            <div>
                <div class="label">Type</div>
                <div class="value">@Model.FileType (@Model.FileFormat)</div>
            </div>

            <div>
                <div class="label">Size</div>
                <div class="value">@string.Format("{0:0.##} MB", sizeInMb)</div>
            </div>

            @if (!string.IsNullOrWhiteSpace(Model.Tags))
            {
                <div class="sm:col-span-2">
                    <div class="label">Tags</div>
                    <div class="value">@Model.Tags</div>
                </div>
            }
        </div>
        <br />
        <div class="flex gap-3">
            <a href="@Model.FilePath"
               target="_blank"
               class="btn-primary">
                Open File
            </a>

            <a asp-action="Index"
               class="btn-gray">
                Back to My Files
            </a>
        </div>

    </section>


    <!-- RIGHT: PREVIEW PANEL -->
    <aside class="flex flex-col flex-1 items-center justify-start">

        @if (isImage)
        {
            <img src="@Model.FilePath"
                 class="max-h-[560px] w-full object-contain rounded-2xl shadow-lg border border-slate-300"
                 alt="@Model.Title" />
        }
        else if (isVideo)
        {
            <video class="max-h-[560px] w-full rounded-2xl shadow-lg" controls>
                <source src="@Model.FilePath" />
            </video>
        }
        else if (isDocument)
        {
            <iframe src="@Model.FilePath"
                    class="viewer-frame"
                    title="Document Preview (PDF)">
            </iframe>
        }
        else
        {
            <div class="details-section text-center text-slate-500">
                Preview unavailable for this file type.
                Use the button above to open or download the file.
            </div>
        }

    </aside>
</div>
