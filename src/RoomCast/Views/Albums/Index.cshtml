@model IEnumerable<RoomCast.Models.Album>

@{
    ViewData["Title"] = "My Albums";
}

<div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-semibold text-slate-800">My Albums</h1>
    <a asp-action="Create"
       class="rc-btn rc-btn-primary">
        <i class="bi bi-plus-circle mr-1"></i> Create Album
    </a>
</div>

<!-- Search Bar -->
<div class="mb-6">
    <form asp-action="Index" method="get" class="flex items-center gap-2">
        <input name="searchString" value="@ViewData["SearchString"]"
               placeholder="Search albums..."
               class="rc-input" />

        <button type="submit" class="rc-btn rc-btn-indigo">
            <i class="bi bi-search mr-1"></i> Search
        </button>
    </form>
    <br />
</div>

@if (!Model.Any())
{
    <div class="rc-empty-box">
        <i class="bi bi-collection text-4xl text-slate-400"></i>
        <p class="mt-2 text-slate-600">No albums found. Click <strong>Create Album</strong> to begin.</p>
    </div>
}
else
{
    <div class="overflow-hidden rounded-2xl bg-white shadow-md ring-1 ring-slate-200">
        <table class="min-w-full divide-y divide-slate-200">
            <thead class="bg-slate-50">
                <tr>
                    <th class="rc-th">Thumbnail</th>
                    <th class="rc-th">Album Name</th>
                    <th class="rc-th">Created</th>
                    <th class="rc-th">Actions</th>
                </tr>
            </thead>

            <tbody class="divide-y divide-slate-100 bg-white">
                @foreach (var album in Model)
                {
                    var firstMedia = album.AlbumFiles?.FirstOrDefault()?.MediaFile;

                    var isVideo = string.Equals(firstMedia?.FileType, "Video", StringComparison.OrdinalIgnoreCase);
                    string thumbPath = firstMedia?.ThumbnailPath ?? firstMedia?.FilePath ?? "~/images/placeholder-thumb.png";
                    thumbPath = Url.Content(thumbPath);

                    <tr class="hover:bg-slate-50 transition">
                        <td class="px-6 py-4">
                            <div class="relative h-24 w-36 rounded-xl overflow-hidden border border-slate-200 shadow-sm">
                                <img src="@thumbPath" alt="Thumbnail" class="object-cover w-full h-full" />

                                @if (isVideo)
                                {
                                    <div class="absolute inset-0 flex items-center justify-center bg-black/40">
                                        <i class="bi bi-play-circle-fill text-white text-3xl drop-shadow"></i>
                                    </div>
                                }
                            </div>
                        </td>

                        <td class="px-6 py-4 text-slate-800 font-medium">
                            @album.AlbumName
                        </td>

                        <td class="px-6 py-4 text-slate-500 text-sm">
                            @album.Timestamp.ToLocalTime().ToString("g")
                        </td>

                        <td class="px-6 py-4">
                            <div class="flex flex-wrap gap-2">

                                <a asp-action="Details" asp-route-id="@album.AlbumId"
                                   class="rc-btn rc-btn-light rc-btn-sm">
                                    <i class="bi bi-eye"></i> View
                                </a>

                                <a asp-action="Edit" asp-route-id="@album.AlbumId"
                                   class="rc-btn rc-btn-blue rc-btn-sm">
                                    <i class="bi bi-pencil-square"></i> Edit
                                </a>

                                <a asp-action="Delete" asp-route-id="@album.AlbumId"
                                   class="rc-btn rc-btn-red rc-btn-sm">
                                    <i class="bi bi-trash"></i> Delete
                                </a>

                                <a asp-controller="Albums" asp-action="AddMedia" asp-route-albumId="@album.AlbumId"
                                   class="rc-btn rc-btn-green rc-btn-sm">
                                    <i class="bi bi-plus-lg"></i> Add Media
                                </a>

                                <a asp-controller="Albums" asp-action="AssignToScreen" asp-route-albumId="@album.AlbumId"
                                   class="rc-btn rc-btn-amber rc-btn-sm">
                                    <i class="bi bi-display"></i> Assign
                                </a>

                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

<style>
    /* Inputs */
    .rc-input {
        width: 220px;
        border-radius: 0.5rem;
        border: 1px solid #CBD5E1;
        padding: 0.5rem 0.75rem;
        font-size: 0.875rem;
        transition: 0.2s;
    }

        .rc-input:focus {
            border-color: #6366f1;
            outline: none;
            box-shadow: 0 0 0 2px #6366f13a;
        }

    /* Empty box */
    .rc-empty-box {
        border: 1px dashed #CBD5E1;
        border-radius: 1rem;
        padding: 3rem;
        background: #fff;
        text-align: center;
        color: #64748B;
    }

    /* Header cells */
    .rc-th {
        padding: 0.75rem 1.5rem;
        text-align: left;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        color: #475569;
        letter-spacing: 0.03em;
    }

    /* Button Base */
    .rc-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        padding: 0.45rem 0.8rem;
        border-radius: 0.5rem;
        font-size: 0.85rem;
        font-weight: 600;
        transition: 0.15s;
        border: 1px solid transparent;
    }

    /* Button Sizes */
    .rc-btn-sm {
        padding: 0.35rem 0.7rem;
        font-size: 0.8rem;
    }

    /* Button Variants */
    .rc-btn-primary {
        background: #059669;
        color: white;
    }

        .rc-btn-primary:hover {
            background: #047857;
        }

    .rc-btn-indigo {
        background: #4F46E5;
        color: white;
    }

        .rc-btn-indigo:hover {
            background: #4338CA;
        }

    .rc-btn-light {
        border: 1px solid #cbd5e1;
        color: #1e40af;
    }

        .rc-btn-light:hover {
            background: #eff6ff;
        }

    .rc-btn-blue {
        border: 1px solid #93c5fd;
        color: #2563eb;
    }

        .rc-btn-blue:hover {
            background: #dbeafe;
        }

    .rc-btn-red {
        border: 1px solid #fecaca;
        color: #dc2626;
    }

        .rc-btn-red:hover {
            background: #fee2e2;
        }

    .rc-btn-green {
        border: 1px solid #bbf7d0;
        color: #047857;
    }

        .rc-btn-green:hover {
            background: #d1fae5;
        }

    .rc-btn-amber {
        border: 1px solid #fde68a;
        color: #b45309;
    }

        .rc-btn-amber:hover {
            background: #fef3c7;
        }
</style>
