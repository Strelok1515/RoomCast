@model RoomCast.ViewModels.ScreenDisplayViewModel

@{
    Layout = null;
    ViewData["Title"] = $"{Model.ScreenName} - Display";
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>@Model.ScreenName - Display</title>

    <style>
        body {
            background: black;
            color: white;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        .media-container {
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        img, video, iframe {
            max-width: 100vw;
            max-height: 100vh;
            object-fit: contain;
        }
    </style>
</head>
<body>

    <div class="media-container">

        @* =============================
           SHOW MEDIA ASSIGNED DIRECTLY
           ============================= *@

        @foreach (var media in Model.AssignedMediaFiles)
        {
            var path = Url.Content(media.FilePath);
            var type = media.FileType?.ToLower() ?? "";
            var ext = media.FileFormat?.ToLower() ?? "";

            if (type == "picture" || type == "image"
            || ext == ".jpg" || ext == ".jpeg" || ext == ".png" || ext == ".gif" || ext == ".webp")
            {
                <img src="@path" alt="@media.Title" />
            }
            else if (type == "video" || ext == ".mp4" || ext == ".mov" || ext == ".mkv" || ext == ".avi")
            {
                <video autoplay muted loop playsinline>
                    <source src="@path" type="@media.ContentType" />
                </video>
            }
            else if (ext == ".pdf")
            {
                <iframe src="@path" width="100%" height="100%"></iframe>
            }
        }


        @* =============================
           SHOW ALBUM MEDIA (IF ANY)
           ============================= *@

        @foreach (var album in Model.AssignedAlbums)
        {
            foreach (var albumMedia in album.AlbumFiles.Select(af => af.MediaFile))
            {
                if (albumMedia == null) continue;

                var path = Url.Content(albumMedia.FilePath);
                var type = albumMedia.FileType?.ToLower() ?? "";
                var ext = albumMedia.FileFormat?.ToLower() ?? "";

                if (type == "picture" || type == "image"
                || ext == ".jpg" || ext == ".jpeg" || ext == ".png" || ext == ".gif" || ext == ".webp")
                {
                    <img src="@path" alt="@albumMedia.Title" />
                }
                else if (type == "video" || ext == ".mp4" || ext == ".mov" || ext == ".mkv" || ext == ".avi")
                {
                    <video autoplay muted loop playsinline>
                        <source src="@path" type="@albumMedia.ContentType" />
                    </video>
                }
                else if (ext == ".pdf")
                {
                    <iframe src="@path" width="100%" height="100%"></iframe>
                }
            }
        }

    </div>

</body>
</html>
